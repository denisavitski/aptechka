"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const k=require("../custom-element/index.cjs"),C=require("../notifier/index.cjs"),x=require("../resizer/index.cjs"),y=require("../ticker/index.cjs"),M=require("../math-FNUBmQPK.cjs");require("../browser-QbF6EW-w.cjs");require("../function-QP7IreXR.cjs");require("../intersector/index.cjs");var W=Object.defineProperty,b=Object.getOwnPropertyDescriptor,R=(i,e,s,r)=>{for(var n=r>1?void 0:r?b(e,s):e,m=i.length-1,f;m>=0;m--)(f=i[m])&&(n=(r?f(e,s,n):f(n))||n);return r&&n&&W(e,s,n),n},E=(i,e,s)=>{if(!e.has(i))throw TypeError("Cannot "+s)},t=(i,e,s)=>(E(i,e,"read from private field"),s?s.call(i):e.get(i)),a=(i,e,s)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,s)},l=(i,e,s,r)=>(E(i,e,"write to private field"),r?r.call(i,s):e.set(i,s),s),p,h,d,c,o,u,v,_,w,g;exports.Canvas2DElement=class extends k.CustomElement{constructor(){super(...arguments),a(this,p,new C.Notifier),a(this,h,null),a(this,d,null),a(this,c,0),a(this,o,0),a(this,u,1),a(this,v,0),a(this,_,1),a(this,w,()=>{l(this,u,M.clamp(devicePixelRatio,1,2));const e=this.getBoundingClientRect();l(this,c,e.width),l(this,o,e.height),t(this,h).width=t(this,c)*this.pixelRatio,t(this,h).height=t(this,o)*this.pixelRatio,this.context.scale(this.pixelRatio,this.pixelRatio),this.renderEvent.notify(this.detail)}),a(this,g,e=>{l(this,v,e.timestamp),l(this,_,e.elapsed),t(this,p).notify(this.detail)})}get renderEvent(){return t(this,p)}get canvasElement(){return t(this,h)}get context(){return t(this,d)}get pixelRatio(){return t(this,u)}get width(){return t(this,c)}get height(){return t(this,o)}get detail(){return{width:t(this,c),height:t(this,o),element:this,canvasElement:t(this,h),pixelRatio:t(this,u),context:t(this,d),timestamp:t(this,v),elapsed:t(this,_)}}connectedCallback(){this.style.display="block",this.style.width="100%",this.style.height="100%",l(this,h,document.createElement("canvas")),t(this,h).style.cssText=`
      display: block;
      width: 100%;
      height: 100%;
    `,l(this,d,t(this,h).getContext("2d")),this.appendChild(t(this,h)),x.resizer.subscribe(t(this,w)),this.hasAttribute("static")||y.ticker.subscribe(t(this,g),{culling:this,maxFPS:this.hasAttribute("fps")?parseInt(this.getAttribute("fps")):void 0})}disconnectedCallback(){x.resizer.unsubscribe(t(this,w)),y.ticker.unsubscribe(t(this,g)),t(this,p).close(),t(this,h).remove(),this.style.display="",this.style.width="",this.style.height=""}};p=new WeakMap;h=new WeakMap;d=new WeakMap;c=new WeakMap;o=new WeakMap;u=new WeakMap;v=new WeakMap;_=new WeakMap;w=new WeakMap;g=new WeakMap;exports.Canvas2DElement=R([k.define("canvas-2d")],exports.Canvas2DElement);
