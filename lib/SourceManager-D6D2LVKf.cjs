"use strict";var b=(c,e,t)=>{if(!e.has(c))throw TypeError("Cannot "+t)};var r=(c,e,t)=>(b(c,e,"read from private field"),t?t.call(c):e.get(c)),o=(c,e,t)=>{if(e.has(c))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(c):e.set(c,t)},i=(c,e,t,n)=>(b(c,e,"write to private field"),n?n.call(c,t):e.set(c,t),t);const B=require("./order/index.cjs"),k=require("./window-resizer/index.cjs"),T=require("./Store-Cr3VaD9G.cjs");var y,g,q,m,a,d,w;class z{constructor(e){o(this,y,void 0);o(this,g,void 0);o(this,q,void 0);o(this,m,void 0);o(this,a,void 0);o(this,d,void 0);o(this,w,void 0);i(this,y,e);const t=e.indexOf("?");t>=0&&(e=e.slice(0,t));const n=e.split(".");i(this,g,n[0]);const x=/\d+x/g,h=n.find(u=>u.match(x));i(this,q,h?parseInt(h):1);const f=/\d+max/g,M=/\d+min/g,s=/\d+mar/g,l=/\d+mir/g,S=n.find(u=>u.match(f)),I=n.find(u=>u.match(M)),V=n.find(u=>u.match(s)),$=n.find(u=>u.match(l));V?(i(this,a,parseInt(V)),i(this,d,"max"),i(this,m,`(max-aspect-ratio: ${r(this,a)})`)):$?(i(this,a,parseInt($)),i(this,d,"max"),i(this,m,`(min-aspect-ratio: ${r(this,a)})`)):S?(i(this,a,parseInt(S)),i(this,d,"max"),i(this,m,`(max-width: ${r(this,a)}px)`)):I?(i(this,a,parseInt(I)),i(this,m,`(min-width: ${r(this,a)}px)`),i(this,d,"min")):(i(this,a,0),i(this,m,`(min-width: ${r(this,a)}px)`),i(this,d,"min")),i(this,w,"."+n[n.length-1])}get url(){return r(this,y)}get name(){return r(this,g)}get density(){return r(this,q)}get query(){return r(this,m)}get extension(){return r(this,w)}get queryType(){return r(this,d)}get queryValue(){return r(this,a)}}y=new WeakMap,g=new WeakMap,q=new WeakMap,m=new WeakMap,a=new WeakMap,d=new WeakMap,w=new WeakMap;var p;class A{constructor(e){o(this,p,void 0);i(this,p,new Map);const t=typeof e=="string"?e.trim().split(",").map(s=>s.trim()).filter(s=>!!s):e,n=[];t.forEach(s=>{const l=new z(s);n.push([l.query,l])});const x=n.filter(s=>s[1].queryType.includes("max")).sort((s,l)=>l[1].queryValue-s[1].queryValue),h=n.filter(s=>s[1].queryType.includes("min")&&s[1].queryValue!==0).sort((s,l)=>s[1].queryValue-l[1].queryValue),f=n.filter(s=>s[0]==="(min-width: 0px)");(f?[...f,...x,...h]:[...x,...h]).forEach(s=>{r(this,p).has(s[0])||r(this,p).set(s[0],[]),r(this,p).get(s[0]).push(s[1])})}get mediaBuckets(){return r(this,p)}}p=new WeakMap;var R,E;class _ extends T.Store{constructor(t){super(void 0);o(this,R,void 0);o(this,E,()=>{let t;r(this,R).mediaBuckets.forEach((h,f)=>{matchMedia(f).matches&&(t=h)});let n,x=0;t==null||t.forEach(h=>{h.density>x&&h.density<=Math.max(devicePixelRatio,1)&&(x=h.density,n=h)}),t!=null&&t.length&&!n&&(n=t[0]),this.current=n});i(this,R,new A(t.srcset))}close(){super.close(),this.disconnect()}connect(){k.windowResizer.subscribe(r(this,E),B.RESIZE_ORDER.SOURCE_MANAGER)}disconnect(){k.windowResizer.unsubscribe(r(this,E))}}R=new WeakMap,E=new WeakMap;exports.Source=z;exports.SourceManager=_;exports.SourceSet=A;
