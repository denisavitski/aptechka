"use strict";var S=(r,s,t)=>{if(!s.has(r))throw TypeError("Cannot "+t)};var n=(r,s,t)=>(S(r,s,"read from private field"),t?t.call(r):s.get(r)),o=(r,s,t)=>{if(s.has(r))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(r):s.set(r,t)},c=(r,s,t,i)=>(S(r,s,"write to private field"),i?i.call(r,t):s.set(r,t),t);const k=require("./order/index.cjs"),M=require("./window-resizer/index.cjs"),z=require("./Store-D0_rDIsE.cjs");var l,g,q,x,a,p,w;class I{constructor(s){o(this,l,void 0);o(this,g,void 0);o(this,q,void 0);o(this,x,void 0);o(this,a,void 0);o(this,p,void 0);o(this,w,void 0);c(this,l,s);const t=s.indexOf("?");t>=0&&(s=s.slice(0,t));const i=s.split(".");c(this,g,i[0]);const m=/\d+x/g,h=i.find(f=>f.match(m));c(this,q,h?parseInt(h):1);const y=/\d+max/g,P=/\d+min/g,e=i.find(f=>f.match(y)),u=i.find(f=>f.match(P));e?(c(this,a,parseInt(e)),c(this,p,"max"),c(this,x,`(max-width: ${n(this,a)}px)`)):u?(c(this,a,parseInt(u)),c(this,x,`(min-width: ${n(this,a)}px)`),c(this,p,"min")):(c(this,a,0),c(this,x,`(min-width: ${n(this,a)}px)`),c(this,p,"min")),c(this,w,"."+i[i.length-1])}get url(){return n(this,l)}get name(){return n(this,g)}get density(){return n(this,q)}get query(){return n(this,x)}get extension(){return n(this,w)}get queryType(){return n(this,p)}get queryPx(){return n(this,a)}}l=new WeakMap,g=new WeakMap,q=new WeakMap,x=new WeakMap,a=new WeakMap,p=new WeakMap,w=new WeakMap;var d;class b{constructor(s){o(this,d,void 0);c(this,d,new Map);const t=typeof s=="string"?s.trim().split(",").map(e=>e.trim()).filter(e=>!!e):s,i=[];t.forEach(e=>{const u=new I(e);i.push([u.query,u])});const m=i.filter(e=>e[1].queryType==="max").sort((e,u)=>u[1].queryPx-e[1].queryPx),h=i.filter(e=>e[1].queryType==="min"&&e[1].queryPx!==0).sort((e,u)=>e[1].queryPx-u[1].queryPx),y=i.filter(e=>e[0]==="(min-width: 0px)");(y?[...y,...m,...h]:[...m,...h]).forEach(e=>{n(this,d).has(e[0])||n(this,d).set(e[0],[]),n(this,d).get(e[0]).push(e[1])})}get mediaBuckets(){return n(this,d)}}d=new WeakMap;var E,R;class B extends z.Store{constructor(t){super(void 0);o(this,E,void 0);o(this,R,()=>{let t;n(this,E).mediaBuckets.forEach((h,y)=>{matchMedia(y).matches&&(t=h)});let i,m=0;t==null||t.forEach(h=>{h.density>m&&h.density<=Math.max(devicePixelRatio,1)&&(m=h.density,i=h)}),t!=null&&t.length&&!i&&(i=t[0]),this.current=i});c(this,E,new b(t.srcset))}close(){super.close(),this.disconnect()}connect(){M.windowResizer.subscribe(n(this,R),k.RESIZE_ORDER.SOURCE_MANAGER)}disconnect(){M.windowResizer.unsubscribe(n(this,R))}}E=new WeakMap,R=new WeakMap;exports.Source=I;exports.SourceManager=B;exports.SourceSet=b;
