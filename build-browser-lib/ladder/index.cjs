"use strict";var j=Object.defineProperty;var w=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var x=(s,t,e)=>t in s?j(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,S=(s,t)=>{for(var e in t||(t={}))C.call(t,e)&&x(s,e,t[e]);if(w)for(var e of w(t))E.call(t,e)&&x(s,e,t[e]);return s};var q=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var i=(s,t,e)=>(q(s,t,"read from private field"),e?e.call(s):t.get(s)),h=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},c=(s,t,e,n)=>(q(s,t,"write to private field"),n?n.call(s,e):t.set(s,e),e);var M=(s,t,e)=>(q(s,t,"access private method"),e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const N=require("../Store-D0_rDIsE.cjs"),O=require("../math-GDWEqu7y.cjs"),U=require("../number-yVpzMdbQ.cjs"),m=require("../ticker/index.cjs");var v,u,p,d;class P{constructor(t){h(this,v,void 0);h(this,u,void 0);h(this,p,void 0);h(this,d,void 0);c(this,v,t.operation),c(this,u,t.value),c(this,p,i(this,u)),c(this,d,t.damping||0)}get operation(){return i(this,v)}get value(){return i(this,u)}set value(t){c(this,p,t),i(this,d)||c(this,u,t)}get damping(){return i(this,d)}set damping(t){c(this,d,t)}update(t){let e=0;for(const n in i(this,u))i(this,u)[n]=O.damp(i(this,u)[n],i(this,p)[n],this.damping,t),U.preciseNumber(i(this,u)[n],4)!==U.preciseNumber(i(this,p)[n],4)&&e++;return e===0}}v=new WeakMap,u=new WeakMap,p=new WeakMap,d=new WeakMap;var g,f,l,y,V,b;class T extends N.Store{constructor(e){super(e,{equalityCheck:()=>!1});h(this,y);h(this,g,void 0);h(this,f,void 0);h(this,l,void 0);h(this,b,e=>{let n=0;for(const r of this.steps){const a=r[1].update(e.elapsed);n+=a?0:1}this.calculate(),n||m.ticker.unsubscribe(i(this,b))});c(this,g,S({},e)),c(this,f,new Map),c(this,l,new Set)}get base(){return i(this,g)}get steps(){return i(this,f)}close(){super.close(),i(this,l).clear(),i(this,f).clear(),m.ticker.unsubscribe(i(this,b))}bind(e){i(this,l).add(e)}unbind(e){i(this,l).delete(e)}deleteStep(e){this.steps.delete(e)}getStepValue(e){return this.steps.get(e).value}setStep(e,n,r,o){const a={};for(const L in this.current)a[L]=r[L]||0;let k=this.steps.get(e);k||(k=new P({operation:n,value:S({},i(this,g)),damping:o}),this.steps.set(e,k)),k.damping=o||0,k.value=a,M(this,y,V).call(this)}calculate(){const e={};for(const n in this.base)e[n]=this.base[n];for(const n of this.steps){const r=n[1];if(r.operation==="+")for(const o in this.base){const a=r.value[o];e[o]+=a}else if(r.operation==="*")for(const o in this.base){const a=r.value[o];e[o]*=a}else if(r.operation==="/")for(const o in this.base){const a=r.value[o];e[o]/=a}else if(r.operation==="-")for(const o in this.base){const a=r.value[o];e[o]-=a}}for(const n of i(this,l))for(const r in e)n[r]=e[r];this.current=e}}g=new WeakMap,f=new WeakMap,l=new WeakMap,y=new WeakSet,V=function(){let e=!1;i(this,f).forEach(n=>{n.damping&&(e=!0)}),e?m.ticker.subscribe(i(this,b)):m.ticker.unsubscribe(i(this,b))},b=new WeakMap;exports.Ladder=T;
