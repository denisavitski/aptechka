"use strict";var p=Object.defineProperty,b=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var S=(s,t,e)=>t in s?p(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,f=(s,t)=>{for(var e in t||(t={}))L.call(t,e)&&S(s,e,t[e]);if(E)for(var e of E(t))N.call(t,e)&&S(s,e,t[e]);return s},c=(s,t)=>b(s,C(t));var w=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var r=(s,t,e)=>(w(s,t,"read from private field"),e?e.call(s):t.get(s)),l=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},v=(s,t,e,o)=>(w(s,t,"write to private field"),o?o.call(s,e):t.set(s,e),e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const y=require("../notifier/index.cjs"),_=require("../function-MthRj-GJ.cjs");var i,h,a,d,n,u,g;class q{constructor(){l(this,i,new Map);l(this,h,new y.Notifier);l(this,a,new y.Notifier);l(this,d,new y.Notifier);l(this,n,!1);l(this,u,t=>{const{loaded:e,total:o}=this.getStats();r(this,h).notify({progress:e/o,loaded:e,total:o,namespace:t}),r(this,g).call(this)});l(this,g,_.debounce(()=>{const{loaded:t,total:e}=this.getStats();if(t===e){v(this,n,!0);const{total:o}=this.getStats();r(this,a).notify({total:o})}},150))}get progressEvent(){return r(this,h)}get completeEvent(){return r(this,a)}get errorEvent(){return r(this,d)}get _counter(){return r(this,i)}get isComplete(){return r(this,n)}reset(){v(this,n,!1),r(this,i).clear()}setTotal(t,e=1){r(this,n)||r(this,i).set(t,{loaded:0,total:e})}setLoaded(t,e=1){if(!r(this,n)&&r(this,i).has(t)){const o=r(this,i).get(t);o.loaded!==e&&(r(this,i).set(t,c(f({},o),{loaded:e})),r(this,u).call(this,t))}}setError(t,e){if(!r(this,n)&&r(this,i).has(t)){const o=r(this,i).get(t);r(this,i).set(t,c(f({},o),{total:o.total-1})),r(this,d).notify({namespace:t,url:e})}}getStats(){return Array.from(r(this,i)).reduce((t,e)=>({loaded:t.loaded+e[1].loaded,total:t.total+e[1].total}),{loaded:0,total:0})}}i=new WeakMap,h=new WeakMap,a=new WeakMap,d=new WeakMap,n=new WeakMap,u=new WeakMap,g=new WeakMap;const M=new q;exports.loading=M;
