"use strict";var S=(i,s,e)=>{if(!s.has(i))throw TypeError("Cannot "+e)};var t=(i,s,e)=>(S(i,s,"read from private field"),e?e.call(i):s.get(i)),h=(i,s,e)=>{if(s.has(i))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(i):s.set(i,e)},r=(i,s,e,n)=>(S(i,s,"write to private field"),n?n.call(i,e):s.set(i,e),e);var o=(i,s,e)=>(S(i,s,"access private method"),e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const B=require("../css-property/index.cjs");require("../Store-Cr3VaD9G.cjs");const L=require("../math-GDWEqu7y.cjs"),y=require("../ticker/index.cjs"),k=require("../tags-BosXYPYv.cjs"),_=require("../createStylesheet-9nksoWW0.cjs"),q=require("../element-resizer/index.cjs"),M=_.createStylesheet({":host, canvas":{display:"block",width:"100%",height:"100%"}});var a,c,d,l,u,m,v,b,g,f,w,z,x,p,R,C,E,F;class P extends HTMLElement{constructor(){super();h(this,g);h(this,w);h(this,R);h(this,E);h(this,a,new B.CSSProperty(this,"--fps",0));h(this,c,null);h(this,d,null);h(this,l,0);h(this,u,0);h(this,m,1);h(this,v,0);h(this,b,1);h(this,x,e=>{r(this,m,L.clamp(devicePixelRatio,1,2)),r(this,l,e.contentRect.width),r(this,u,e.contentRect.height),t(this,c).width=t(this,l)*this.pixelRatio,t(this,c).height=t(this,u)*this.pixelRatio,this.context.scale(this.pixelRatio,this.pixelRatio),o(this,E,F).call(this),o(this,R,C).call(this)});h(this,p,e=>{r(this,v,e.timestamp),r(this,b,e.timeBetweenFrames),o(this,R,C).call(this)});this.attachShadow({mode:"open"}).adoptedStyleSheets.push(M),k.element(this,{children:k.canvas({ref:n=>{r(this,c,n),r(this,d,n.getContext("2d"))}})}),t(this,a).subscribe(n=>{typeof n.previous!="undefined"&&n.current!==n.previous&&o(this,g,f).call(this)})}get fpsCSSProperty(){return t(this,a)}get canvasElement(){return t(this,c)}get context(){return t(this,d)}get pixelRatio(){return t(this,m)}get width(){return t(this,l)}get height(){return t(this,u)}get detail(){return{width:t(this,l),height:t(this,u),element:this,canvasElement:t(this,c),pixelRatio:t(this,m),context:t(this,d),timestamp:t(this,v),timeBetweenFrames:t(this,b)}}connectedCallback(){t(this,a).observe(),q.elementResizer.subscribe(this,t(this,x)),o(this,g,f).call(this)}disconnectedCallback(){t(this,a).unobserve(),q.elementResizer.unsubscribe(t(this,x)),o(this,w,z).call(this)}}a=new WeakMap,c=new WeakMap,d=new WeakMap,l=new WeakMap,u=new WeakMap,m=new WeakMap,v=new WeakMap,b=new WeakMap,g=new WeakSet,f=function(){y.ticker.unsubscribe(t(this,p)),this.hasAttribute("static")||y.ticker.subscribe(t(this,p),{culling:this,maxFPS:t(this,a).current})},w=new WeakSet,z=function(){y.ticker.unsubscribe(t(this,p))},x=new WeakMap,p=new WeakMap,R=new WeakSet,C=function(){this.dispatchEvent(new CustomEvent("canvasRender",{composed:!0,detail:this.detail}))},E=new WeakSet,F=function(){this.dispatchEvent(new CustomEvent("canvasResize",{composed:!0,detail:this.detail}))};customElements.get("e-canvas")||customElements.define("e-canvas",P);exports.CanvasElement=P;
