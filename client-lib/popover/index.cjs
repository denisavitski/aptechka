"use strict";var q=(o,n,t)=>{if(!n.has(o))throw TypeError("Cannot "+t)};var e=(o,n,t)=>(q(o,n,"read from private field"),t?t.call(o):n.get(o)),i=(o,n,t)=>{if(n.has(o))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(o):n.set(o,t)},h=(o,n,t,a)=>(q(o,n,"write to private field"),a?a.call(o,t):n.set(o,t),t);var A=(o,n,t)=>(q(o,n,"access private method"),t);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const $=require("../attribute/index.cjs"),I=require("../Store-Cr3VaD9G.cjs"),R=require("../style-At6aDoqG.cjs"),N=require("../browser-CpzFX2xg.cjs");require("../ticker/index.cjs");const j=require("../tags-BosXYPYv.cjs");var m,l,y,p,d,u,_,x,v,L,f,E,b,M,g;const c=class c extends HTMLElement{constructor(){super();i(this,_);i(this,v);i(this,b);i(this,m,void 0);i(this,l,void 0);i(this,y,void 0);i(this,p,void 0);i(this,d,void 0);i(this,u,void 0);i(this,f,void 0);i(this,E,void 0);i(this,g,void 0);h(this,m,-1),h(this,l,new I.Store(!1)),h(this,p,new $.Attribute(this,"history",!1)),h(this,d,new $.Attribute(this,"single",!1)),h(this,u,!1),this.open=(t=!0)=>{if(e(this,l).current)return;e(this,l).current=!0,e(this,d).current&&(c.__opened.forEach(r=>r.close()),c.__opened=[]),c.__opened.push(this),h(this,m,c.__opened.length-1),e(this,p).current&&e(this,u)&&history.pushState("","",e(this,_,x)),clearTimeout(e(this,y)),this.classList.add("triggered"),this.style.display="block",this.dispatchEvent(new CustomEvent("popoverTriggered"));const a=()=>{addEventListener("click",e(this,f)),addEventListener("keydown",e(this,E)),this.style.opacity="1",this.classList.add("opened"),this.dispatchEvent(new CustomEvent("popoverOpened"))};t?setTimeout(a):a()},this.close=()=>{if(e(this,l).current){if(e(this,l).current=!1,c.__opened=c.__opened.filter(t=>t!==this),e(this,p).current){const t=new URL(location.href);t.searchParams.delete(e(this,v,L)),history.replaceState(null,"",t.href)}this.classList.remove("opened"),this.style.opacity="0",this.dispatchEvent(new CustomEvent("popoverClosing")),removeEventListener("click",e(this,f)),removeEventListener("keydown",e(this,E)),setTimeout(()=>{this.classList.remove("triggered"),this.style.display="none",this.dispatchEvent(new CustomEvent("popoverClosed"))},R.getElementTransitionDurationMS(this)+10)}},h(this,f,t=>{A(this,b,M).call(this,()=>{var O;const r=t.composedPath()[0],P=r instanceof HTMLElement&&(this.contains(r)||((O=this.shadowRoot)==null?void 0:O.contains(r))),B=r instanceof HTMLElement&&r.hasAttribute("outside");(!P||B)&&this.close()})}),h(this,E,t=>{A(this,b,M).call(this,()=>{t.code==="Escape"&&this.close()})}),h(this,g,()=>{h(this,u,!1),e(this,l).current&&e(this,p).current&&!location.search.includes(e(this,v,L))?this.close():!e(this,l).current&&e(this,p).current&&location.search.includes(e(this,v,L))&&this.open(),h(this,u,!0)}),this.setAttribute("popover-target","")}get history(){return e(this,p)}get single(){return e(this,d)}get opened(){return e(this,l)}connectedCallback(){e(this,p).observe(),e(this,d).observe(),this.style.opacity="0",this.style.display="none",addEventListener("popstate",e(this,g)),setTimeout(()=>{e(this,g).call(this)},0)}disconnectedCallback(){e(this,p).unobserve(),e(this,d).unobserve(),c.__opened=c.__opened.filter(t=>t!==this),clearTimeout(e(this,y)),removeEventListener("popstate",e(this,g))}};m=new WeakMap,l=new WeakMap,y=new WeakMap,p=new WeakMap,d=new WeakMap,u=new WeakMap,_=new WeakSet,x=function(){return`${location.pathname}${location.search?location.search+"&":"?"}${e(this,v,L)}`},v=new WeakSet,L=function(){return`modal-${this.id}`},f=new WeakMap,E=new WeakMap,b=new WeakSet,M=function(t){(c.__opened[e(this,m)-1]||c.__opened.length===1)&&t()},g=new WeakMap,c.__opened=[];let S=c;customElements.get("e-popover")||customElements.define("e-popover",S);var s,T,w,C,k;class H extends HTMLElement{constructor(){super();i(this,s,void 0);i(this,T,()=>{this.classList.add("triggered")});i(this,w,()=>{this.classList.add("opened")});i(this,C,()=>{this.classList.remove("opened")});i(this,k,()=>{this.classList.remove("triggered")});N.isBrowser&&j.element(this,{tabindex:this.getAttribute("tabindex")||"0",onClick:()=>{if(e(this,s)){const t=this.getAttribute("type")||"open";t==="open"||t==="toggle"&&!e(this,s).opened.current?e(this,s).open():(t==="close"||t==="toggle"&&e(this,s).opened.current)&&e(this,s).close()}},onKeydown:t=>{t.code==="Space"&&t.currentTarget.click()}})}get popoverElement(){return e(this,s)}connectedCallback(){var a;const t=this.getAttribute("target");if(t){let r=null;t==="parent"?r=this.closest("[popover-target]"):t==="sibling"?r=(a=this.parentElement)==null?void 0:a.querySelector("[popover-target]"):r=document.querySelector(`#${t}`)||this.getRootNode().querySelector(`#${t}`),r instanceof HTMLElement?(h(this,s,r),e(this,s).addEventListener("popoverTriggered",e(this,T)),e(this,s).addEventListener("popoverOpened",e(this,w)),e(this,s).addEventListener("popoverClosing",e(this,C)),e(this,s).addEventListener("popoverClosed",e(this,k))):console.warn(this,`target ${t} not found`)}}disconnectedCallback(){e(this,s)&&(e(this,s).removeEventListener("popoverTriggered",e(this,T)),e(this,s).removeEventListener("popoverOpened",e(this,w)),e(this,s).removeEventListener("popoverClosing",e(this,C)),e(this,s).removeEventListener("popoverClosed",e(this,k)))}}s=new WeakMap,T=new WeakMap,w=new WeakMap,C=new WeakMap,k=new WeakMap;customElements.get("e-popover-button")||customElements.define("e-popover-button",H);exports.PopoverButtonElement=H;exports.PopoverElement=S;
